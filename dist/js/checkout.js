(()=>{"use strict";async function t(){try{const t=await fetch("/server/auth_verification.php");if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){return console.error("Error checking user login:",t),!1}}const e={totalPriceValue:0};document.addEventListener("DOMContentLoaded",(function(){const n=document.querySelector(".checkout__subtotal"),o=document.querySelector(".checkout__subtotal-value"),r=document.querySelector(".checkout__shipping-value"),c=document.querySelector(".checkout__total-value"),l=document.querySelector(".checkout__country-select"),i=document.querySelectorAll(".checkout__shiping-ua"),a=document.querySelectorAll(".checkout__shiping-pl"),s=document.querySelectorAll(".shipping_method");!function(){const t=document.querySelectorAll(".checkout__blik-input, .checkout__card-input");t&&t.forEach((t=>{t.addEventListener("change",(function(){const t=this.getAttribute("data-description"),e=document.getElementById(t);document.querySelectorAll(".checkout__payment-description").forEach((t=>{t.style.height="0",t.style.opacity="0"})),e&&(e.style.height="calc(var(--index) * 1)",e.style.opacity="1")}))}))}(),async function(){await async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;function a(t){i&&i.forEach((e=>{if(e.getAttribute("data-id")==t){let t=e.querySelector(".frame__shop-button, .frame__shop-button-left");t.innerHTML="Added!",t.classList.add("added")}}))}!async function(){try{const c=await l();let i=c?c.id:null;const s=await fetch("/server/cart_all_products.php");if(!s.ok)throw new Error("Network response was not ok");(await s.json()).forEach((c=>{if(c.user_id==i){e.totalPriceValue+=parseInt(c.price),a(c.product_id);const l=`\n                        <tr class="products" data-product="${c.product_id}" data-user="${c.user_id}">\n                            <td>\n                                <img class="cart__product-img" src="${c.image}" alt="${c.name}">\n                            </td>\n                            <td>\n                                <ul>\n                                    <li>${c.name}</li>\n                                    <li>${c.description}</li>\n                                    <li>${c.size}</li>\n                                </ul>\n                            </td>\n                            <td>€${c.price}</td>\n                            <td>\n                                <img class="cart__delete-icon delete-icon" src="/img/delete-icon.png" alt="delete">\n                            </td>\n                        </tr>`;t&&(t.style.visibility="visible",n.style.visibility="visible",o.style.visibility="visible",r.style.display="none"),n.insertAdjacentHTML("beforebegin",l)}}))}catch(t){console.error("Error fetching products:",t)}c.innerHTML="€"+e.totalPriceValue}(),async function(){if(!await l()){const l=JSON.parse(localStorage.getItem("localStorArr"))||[];l.length>0&&(l.forEach((c=>{a(c.productId),e.totalPriceValue+=parseInt(c.price);const l=`\n                        <tr class="products" data-product="${c.productId}" data-user = "0">\n                            <td>\n                                <img class="cart__product-img" src="${c.image}" alt="${c.name}">\n                            </td>\n                            <td>\n                                <ul>\n                                    <li>${c.name}</li>\n                                    <li>${c.description}</li>\n                                    <li>${c.size}</li>\n                                </ul>\n                            </td>\n                            <td>€${c.price}</td>\n                            \n                            <td>\n                                <img class="cart__delete-icon delete-icon" src="/img/delete-icon.png" alt="delete">\n                            </td>\n                        </tr>`;t&&(t.style.visibility="visible",n.style.visibility="visible",o.style.visibility="visible",r.style.display="none"),n.insertAdjacentHTML("beforebegin",l)})),c.innerHTML="€"+e.totalPriceValue)}}()}(null,n,null,null,o,t,null),setTimeout((function(){const t=parseFloat(r?.innerText.replaceAll("€","").trim())||0,e=parseFloat(o?.innerText.replaceAll("€","").trim())||0,n=t+e,u=document.querySelectorAll(".cart__delete-icon"),d=document.querySelectorAll(".products");let p=[];function h(){const n=e-t;l&&("pl"===l.value&&(c.textContent="€"+n,r.textContent="€00.00",i.forEach((t=>{t.closest(".checkout__input").style.display="none",t.removeAttribute("required")})),a.forEach((t=>{t.closest(".checkout__input").style.display="flex",t.setAttribute("required","")}))),"ua"===l.value&&(c.textContent="€"+n,r.textContent="€00.00",a.forEach((t=>{t.closest(".checkout__input").style.display="none",t.removeAttribute("required")})),i.forEach((t=>{t.closest(".checkout__input").style.display="flex",t.setAttribute("required","")}))))}u.length>0&&u.forEach((t=>{t.style.display="none"})),c.textContent="€"+n,s.forEach((t=>{t.addEventListener("click",(()=>{const n=parseFloat(t.value.match(/[\d.]+/)[0])||0;r.textContent="€"+n;let o=n+e;c.textContent="€"+o}))})),h(),function(){const t=document.getElementById("user_id"),e=document.getElementById("product_id"),n=document.querySelector(".pay");let l;if(d){d.forEach((e=>{const n=e.getAttribute("data-product");t&&(l=e.getAttribute("data-user")),p.push(n)}));let n=p.join(",");t&&(t.setAttribute("value",l),e.setAttribute("value",n))}n&&function(){const t={productIds:p};fetch("/server/pay_page.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(!t.ok)throw new Error(`Network response was not ok: ${t.status}`);return t.json()})).then((t=>{const e=document.querySelector(".pay__order-id"),n=document.querySelector(".pay__order-date"),l=document.querySelector(".pay__order-payment"),i=document.querySelector(".pay__order-shiping");e.textContent=t[0].id,n.textContent=t[0].date,l.textContent=t[0].payment,i.textContent=t[0].shipping;const a=parseFloat(t[0].shipping.match(/[\d.]+/)[0])||0;r.textContent="€"+a;const s=a+(parseFloat(o?.innerText.replaceAll("€","").trim())||0);c.textContent="€"+s})).then((()=>{!function(t){const e=JSON.parse(localStorage.getItem("localStorArr"))||[];t.forEach((t=>{e.forEach(((n,o)=>{t===n.productId&&e.splice(o,1)}))})),localStorage.setItem("localStorArr",JSON.stringify(e))}(p)})).catch((t=>{console.error("There was a problem with the fetch operation:",t)}))}()}(),l&&l.addEventListener("change",h)}),200)}()}))})();